<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WOIC 2025 Badge Generator</title>

  <!-- Open Graph (for LinkedIn, Facebook, etc.) -->
  <meta property="og:title" content="WOIC 2025 Badge Generator" />
  <meta property="og:description" content="Create your personalized 'I am attending #WOIC2025' badge by uploading your photo." />
  <meta property="og:image" content="https://yourusername.github.io/woic-badge/woic-frame.png" />
  <meta property="og:url" content="https://yourusername.github.io/woic-badge/" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card (for Twitter/X) -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="WOIC 2025 Badge Generator">
  <meta name="twitter:description" content="Create your personalized 'I am attending #WOIC2025' badge by uploading your photo.">
  <meta name="twitter:image" content="https://yourusername.github.io/woic-badge/woic-frame.png">

  <!-- Google Fonts: Montserrat -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #14284b;
      --accent: #ffce00;
      --font: 'Montserrat', sans-serif;
    }
    body {
      margin: 0; font-family: var(--font);
      background: var(--bg); color: #fff;
      text-align: center; padding: 24px;
    }
    h1 { margin: 0 0 10px; font-weight: 700; }
    p { font-weight: 400; }
    canvas {
      width: min(90vw, 800px); /* preview size */
      height: auto;
      border: 2px solid var(--accent);
      border-radius: 16px;
      margin-top: 20px;
      background: #000;
      cursor: grab;
    }
    .controls {
      margin-top: 16px;
      display: flex; justify-content: center;
      gap: 12px; flex-wrap: wrap;
    }
    .btn {
      background: var(--accent); color: #111;
      font-family: var(--font); font-weight: 600;
      border: none; border-radius: 8px;
      padding: 12px 24px; font-size: 16px;
      cursor: pointer; min-width: 160px;
      transition: background 0.2s ease;
    }
    .btn:hover { background: #e0b800; }
    input[type="file"] { display: none; }
    .slider {
      width: 200px;
    }
    .zoom-controls {
      margin-top: 12px;
      display: flex; justify-content: center; align-items: center;
      gap: 8px;
    }
  </style>
</head>
<body>
  <h1>WOIC 2025 Badge Generator</h1>
  <p>Upload and adjust your photo, then download your badge with the official frame.</p>

  <!-- Buttons -->
  <div class="controls">
    <label class="btn">
      <input id="file" type="file" accept="image/*" />
      Upload Photo
    </label>
    <button id="download" class="btn">Download Badge</button>
    <button id="reset" class="btn">Reset</button>
  </div>

  <!-- Zoom slider -->
  <div class="zoom-controls">
    <button id="zoomOut" class="btn">â€“</button>
    <input id="zoomSlider" type="range" min="0.1" max="3" step="0.01" value="1" class="slider">
    <button id="zoomIn" class="btn">+</button>
  </div>

  <!-- Final Badge -->
  <canvas id="canvas"></canvas>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const fileInput = document.getElementById('file');
    const btnDownload = document.getElementById('download');
    const btnReset = document.getElementById('reset');
    const zoomSlider = document.getElementById('zoomSlider');
    const zoomIn = document.getElementById('zoomIn');
    const zoomOut = document.getElementById('zoomOut');

    const frame = new Image();
    frame.src = 'woic-frame.png'; // must be in repo folder
    let userImg = null;
    let scale = 1, offsetX = 0, offsetY = 0;
    let dragging = false, lastX = 0, lastY = 0;

    frame.onload = () => {
      // Match canvas resolution to frame's original size (e.g. 2500x2500)
      canvas.width = frame.naturalWidth;
      canvas.height = frame.naturalHeight;
      draw();
    };

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (userImg) {
        const imgW = userImg.width * scale;
        const imgH = userImg.height * scale;
        const x = canvas.width/2 - imgW/2 + offsetX;
        const y = canvas.height/2 - imgH/2 + offsetY;
        ctx.drawImage(userImg, x, y, imgW, imgH);
      }
      ctx.drawImage(frame, 0, 0, canvas.width, canvas.height);
    }

    // Upload
    fileInput.addEventListener('change', e => {
      const file = e.target.files && e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = ev => {
        userImg = new Image();
        userImg.onload = () => {
          scale = 1; offsetX = 0; offsetY = 0;
          zoomSlider.value = 1;
          draw();
        };
        userImg.src = ev.target.result;
      };
      reader.readAsDataURL(file);
    });

    // Drag to move
    canvas.addEventListener('mousedown', e => {
      dragging = true;
      lastX = e.offsetX * (canvas.width / canvas.clientWidth);
      lastY = e.offsetY * (canvas.height / canvas.clientHeight);
      canvas.style.cursor = "grabbing";
    });
    canvas.addEventListener('mousemove', e => {
      if (!dragging) return;
      const currX = e.offsetX * (canvas.width / canvas.clientWidth);
      const currY = e.offsetY * (canvas.height / canvas.clientHeight);
      const dx = currX - lastX;
      const dy = currY - lastY;
      offsetX += dx;
      offsetY += dy;
      lastX = currX;
      lastY = currY;
      draw();
    });
    canvas.addEventListener('mouseup', () => { dragging = false; canvas.style.cursor = "grab"; });
    canvas.addEventListener('mouseleave', () => { dragging = false; canvas.style.cursor = "grab"; });

    // Zoom slider
    zoomSlider.addEventListener('input', () => {
      scale = parseFloat(zoomSlider.value);
      draw();
    });
    zoomIn.addEventListener('click', () => {
      scale = Math.min(3, scale + 0.1);
      zoomSlider.value = scale;
      draw();
    });
    zoomOut.addEventListener('click', () => {
      scale = Math.max(0.1, scale - 0.1);
      zoomSlider.value = scale;
      draw();
    });

    // Download
    btnDownload.addEventListener('click', () => {
      const link = document.createElement('a');
      link.download = 'WOIC2025_Badge.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    });

    // Reset
    btnReset.addEventListener('click', () => {
      fileInput.value = '';
      userImg = null;
      scale = 1; offsetX = 0; offsetY = 0;
      zoomSlider.value = 1;
      draw();
    });
  </script>
</body>
</html>
